<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Shop - Mua v·∫≠t ph·∫©m game nhanh, an to√†n, uy t√≠n</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/home.css">
    <link rel="stylesheet" href="/css/modern-layout.css">
</head>
<body>
    <!-- Header -->
    <header class="modern-header">
        <div class="container">
            <div class="header-content">
                <!-- Logo -->
                <a href="/" class="header-logo">
                    <img src="/images/logo/roblox-app-icon-hd-removebg-preview.png" alt="Solo Shop Logo">
                    <span>Solo Shop</span>
                </a>
                
                <!-- Search Bar -->
                <div class="header-search">
                    <input type="text" placeholder="T√¨m s·∫£n ph·∫©m, d·ªãch v·ª•..." id="search-input">
                    <button class="search-btn">üîç</button>
                </div>
                
                <!-- Navigation Actions -->
                <div class="header-actions">
                    <a href="/contact.html" class="header-link">
                        <span class="icon">üí¨</span>
                        <span>H·ªó tr·ª£</span>
                    </a>
                    <a href="/orders.html" class="header-link">
                        <span class="icon">üìã</span>
                        <span>L·ªãch s·ª≠</span>
                    </a>
                    <a href="/cart.html" class="header-btn btn-recharge">
                        <span class="icon">üí≥</span>
                        <span>N·∫°p ti·ªÅn</span>
                    </a>
                    <div id="auth-btn-modern"></div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Hero Section with Video & Banners -->
        <section class="hero-modern">
            <div class="container">
                <div class="hero-grid">
                    <!-- Left: Video -->
                    <div class="hero-video-section">
                        <div class="video-wrapper">
                            <iframe id="hero-video" src="https://www.youtube.com/embed/dQw4w9WgXcQ?enablejsapi=1" 
                                    title="Video gi·ªõi thi·ªáu" 
                                    frameborder="0" 
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                    allowfullscreen>
                            </iframe>
                        </div>
                    </div>
                
                    <!-- Right: Banners & Info -->
                    <div class="hero-banners-section">
                        <div class="banner-item banner-primary">
                            <img src="/images/banner/Roblox_poster__63237.jpg" alt="Banner ∆∞u ƒë√£i ƒë·∫∑c bi·ªát">
                            <div class="banner-overlay">
                                <h3>üéÅ ∆Øu ƒê√£i ƒê·∫∑c Bi·ªát</h3>
                                <p>Nh·∫≠n ngay khuy·∫øn m√£i h·∫•p d·∫´n</p>
                            </div>
                        </div>
                        <div class="banner-item banner-secondary">
                            <img src="/images/banner/Roblox_poster__63237.jpg" alt="Banner s·ª± ki·ªán m·ªõi">
                            <div class="banner-overlay">
                                <h3>üéÆ S·ª± Ki·ªán Hot</h3>
                                <p>C·∫≠p nh·∫≠t game m·ªõi nh·∫•t</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    
        <!-- All Games Categories Section -->
        <section class="all-games-section">
            <div class="container">
                <div class="games-categories-grid" id="all-games-categories">
                    <!-- All game categories will be loaded here -->
                    <div style="text-align: center; padding: 60px 20px;">
                        <div class="loading-spinner">‚è≥ ƒêang t·∫£i danh m·ª•c...</div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3><img src="/images/logo/roblox-app-icon-hd-removebg-preview.png" alt="GameShop" style="height: 30px; vertical-align: middle;"> GameShop</h3>
                    <p>N·ªÅn t·∫£ng mua v·∫≠t ph·∫©m game uy t√≠n, nhanh ch√≥ng v√† an to√†n nh·∫•t Vi·ªát Nam.</p>
                    <div class="social-links">
                        <a href="https://www.facebook.com/tuan.474" title="Facebook" target="_blank">üìò</a>
                        <a href="https://zalo.me/0363296105" title="Zalo" target="_blank">üí¨</a>
                        <a href="mailto:aquattda@gmail.com" title="Email" target="_blank">üìß</a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Li√™n H·ªá</h3>
                    <p>üìû Hotline: 0363296105</p>
                    <p>üìß Email: aquattda@gmail.com</p>
                    <p>üí¨ Zalo: 0363296105</p>
                    <p>üïê H·ªó tr·ª£: 8:00 - 22:00 h√†ng ng√†y</p>
                </div>
                
                <div class="footer-section">
                    <h3>Ch√≠nh S√°ch</h3>
                    <a href="#">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a>
                    <a href="#">Ch√≠nh s√°ch b·∫£o m·∫≠t</a>
                    <a href="#">H∆∞·ªõng d·∫´n mua h√†ng</a>
                    <a href="#">C√¢u h·ªèi th∆∞·ªùng g·∫∑p</a>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>‚ö†Ô∏è L∆∞u √Ω: Trang web kh√¥ng thu·ªôc s·ªü h·ªØu c·ªßa Roblox, Garena, hay b·∫•t k·ª≥ nh√† ph√°t tri·ªÉn game n√†o. Ch√∫ng t√¥i ch·ªâ cung c·∫•p d·ªãch v·ª• n·∫°p v·∫≠t ph·∫©m h·ª£p l·ªá.</p>
                <p>&copy; 2025 GameShop. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="/js/app.js"></script>
    <script src="/js/customer-auth.js"></script>
    <script src="/js/home.js"></script>
    <script>
        // Load Roblox Services
        async function loadRobloxServices() {
            try {
                // Get Roblox game categories (assuming Roblox games have IDs 1-11)
                // Let's try game_id = 1 (BloxFruits) for the service section
                const result = await API.getCategoriesByGame(1);
                
                if (result.success && result.data.length > 0) {
                    const servicesContainer = document.getElementById('roblox-services');
                    servicesContainer.innerHTML = result.data.map(category => `
                        <div class="service-card" onclick="navigateTo('/product.html?game_id=1&category_id=${category.category_id}')">
                            <div class="service-icon">
                                ${category.icon ? `<span style="font-size: 48px;">${category.icon}</span>` : 'üéÆ'}
                            </div>
                            <h3 class="service-name">${category.name}</h3>
                        </div>
                    `).join('');
                } else {
                    console.log('No categories found for Roblox services');
                }
            } catch (error) {
                console.error('Error loading Roblox services:', error);
            }
        }
        
        // Load Product Sections
        async function loadAllGamesCategories() {
            try {
                const container = document.getElementById('all-games-categories');
                
                // Define sections v·ªõi category_id v√† game_id c·ª• th·ªÉ
                const sections = [
                    { 
                        title: 'Tr√°i √Åc Qu·ª∑', 
                        icon: 'üçá', 
                        game_id: 1, 
                        category_id: 1,
                        categoryName: 'Tr√°i'
                    },
                    { 
                        title: 'V·∫≠t Ph·∫©m Blox Fruit', 
                        icon: 'üó°Ô∏è', 
                        game_id: 1, 
                        category_id: 2,
                        categoryName: 'Gamepass'
                    },
                    { 
                        title: 'Units', 
                        icon: 'ü§ñ', 
                        game_id: 3, 
                        category_id: 3,
                        categoryName: 'Units'
                    },
                    { 
                        title: 'V·∫≠t Ph·∫©m King Legacy', 
                        icon: 'üè¥‚Äç‚ò†Ô∏è', 
                        game_id: 2, 
                        category_id: 4,
                        categoryName: 'Items'
                    }
                ];
                
                let htmlContent = '';
                
                // Load products for each section
                for (const section of sections) {
                    try {
                        // Get products by game_id and category_id
                        const productsResult = await API.getProducts({
                            game_id: section.game_id,
                            category_id: section.category_id
                        });
                        
                        console.log(`Products for ${section.title}:`, productsResult);
                        
                        if (productsResult.success && productsResult.data && productsResult.data.length > 0) {
                            // Limit to 10 products per section
                            const displayProducts = productsResult.data.slice(0, 5);
                            
                            htmlContent += `
                                <div class="game-category-section">
                                    <div class="game-category-header">
                                        <div class="game-category-header-left">
                                            <div class="category-icon">${section.icon}</div>
                                            <div class="category-info">
                                                <h2>${section.title}</h2>
                                            </div>
                                        </div>
                                        <a href="/product.html?game_id=${section.game_id}&category_id=${section.category_id}" class="view-more-btn">Xem Th√™m</a>
                                    </div>
                                    <div class="category-items-grid">
                                        ${displayProducts.map(product => `
                                            <div class="category-item-card" onclick="navigateTo('/product.html?game_id=${section.game_id}&category_id=${section.category_id}')">
                                                <div class="category-item-icon">
                                                    ${product.image_url ? `<img src="${product.image_url}" alt="${product.name}">` : 'üéÆ'}
                                                </div>
                                                <h3 class="category-item-name">${product.name}</h3>
                                                <div class="category-item-price">${product.price ? product.price.toLocaleString('vi-VN') + 'ƒë' : 'Li√™n h·ªá'}</div>
                                                <button class="btn btn-primary btn-sm">Thanh To√°n</button>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        } else {
                            console.log(`No products found for ${section.title}`);
                        }
                    } catch (err) {
                        console.error(`Error loading products for ${section.title}:`, err);
                    }
                }
                
                if (htmlContent) {
                    // Add "View All Categories" section at the end
                    htmlContent += `
                        <div class="view-all-categories-section">
                            <div class="view-all-content">
                                <div class="view-all-icon">üéÆ</div>
                                <h3>Kh√°m ph√° th√™m nhi·ªÅu danh m·ª•c kh√°c</h3>
                                <p>Xem to√†n b·ªô danh m·ª•c game Roblox v√† s·∫£n ph·∫©m</p>
                                <a href="/games.html" class="btn-view-all">Xem T·∫•t C·∫£ Danh M·ª•c ‚Üí</a>
                            </div>
                        </div>
                    `;
                    container.innerHTML = htmlContent;
                } else {
                    container.innerHTML = '<p style="text-align:center;padding:40px;color:#999;">Ch∆∞a c√≥ s·∫£n ph·∫©m n√†o</p>';
                }
            } catch (error) {
                console.error('Error loading products:', error);
                document.getElementById('all-games-categories').innerHTML = '<p style="text-align:center;padding:40px;color:#ff6b6b;">L·ªói khi t·∫£i s·∫£n ph·∫©m. Vui l√≤ng th·ª≠ l·∫°i sau.</p>';
            }
        }
        
        // Modern Auth Button
        function updateModernAuthButton() {
            const authBtn = document.getElementById('auth-btn-modern');
            if (!authBtn) return;
            
            if (CustomerAuth && CustomerAuth.isLoggedIn()) {
                const customer = CustomerAuth.getCustomer();
                authBtn.innerHTML = `
                    <div class="user-menu-modern">
                        <button class="header-btn btn-login" onclick="toggleUserDropdown()">
                            <span class="icon">üë§</span>
                            <span>${customer.name || customer.email}</span>
                        </button>
                        <div class="user-dropdown-modern" id="user-dropdown-modern">
                            <a href="/account.html">T√†i kho·∫£n</a>
                            <a href="/orders.html">ƒê∆°n h√†ng</a>
                            <a href="#" onclick="CustomerAuth.logout(); return false;">ƒêƒÉng xu·∫•t</a>
                        </div>
                    </div>
                `;
            } else {
                authBtn.innerHTML = `
                    <a href="/login.html" class="header-btn btn-login">
                        <span class="icon">üîê</span>
                        <span>ƒêƒÉng nh·∫≠p</span>
                    </a>
                `;
            }
        }
        
        function toggleUserDropdown() {
            const dropdown = document.getElementById('user-dropdown-modern');
            if (dropdown) {
                dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
            }
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            const dropdown = document.getElementById('user-dropdown-modern');
            const userMenu = document.querySelector('.user-menu-modern');
            if (dropdown && userMenu && !userMenu.contains(e.target)) {
                dropdown.style.display = 'none';
            }
        });
        
        // Auto-pause video when scrolling away
        const videoIframe = document.getElementById('hero-video');
        const heroSection = document.querySelector('.hero-modern');
        
        window.addEventListener('scroll', function() {
            if (!videoIframe || !heroSection) return;
            
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            const sectionBottom = heroSection.offsetTop + heroSection.offsetHeight;
            
            if (scrollTop > sectionBottom - 200) {
                const currentSrc = videoIframe.src;
                if (currentSrc && !currentSrc.includes('autoplay=0')) {
                    videoIframe.src = currentSrc.replace('?enablejsapi=1', '?enablejsapi=1&autoplay=0');
                }
            }
        });
        
        // Search functionality
        document.getElementById('search-input')?.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const query = this.value.trim();
                if (query) {
                    navigateTo(`/games.html?search=${encodeURIComponent(query)}`);
                }
            }
        });
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Page loaded, initializing...');
            loadRobloxServices();
            loadAllGamesCategories();
            updateModernAuthButton();
        });
    </script>
</body>
</html>
